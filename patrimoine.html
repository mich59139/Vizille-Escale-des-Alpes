<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Carte Patrimoniale ‚Äî Vizille Escale des Alpes</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css" />
  <style>
    :root {
      --slate-blue: #1e3a5f;
      --heritage-ocre: #c9a227;
      --alpine-green: #2d6a4f;
      --cream: #f5f3ef;
      --white: #ffffff;
      --text: #2d3748;
      --font-display: 'Playfair Display', Georgia, serif;
      --font-body: 'Inter', sans-serif;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: var(--font-body); background: var(--cream); }
    
    /* Header */
    .header {
      background: var(--white);
      border-bottom: 1px solid rgba(30,58,95,0.1);
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1000;
    }
    .logo { display: flex; flex-direction: column; line-height: 1; }
    .logo-main { font-family: var(--font-display); font-size: 1.25rem; font-weight: 600; color: var(--slate-blue); letter-spacing: 2px; }
    .logo-sub { font-family: var(--font-display); font-size: 0.55rem; letter-spacing: 3px; color: var(--heritage-ocre); }
    .logo-des { font-size: 0.4rem; vertical-align: middle; margin: 0 2px; opacity: 0.6; }
    .header-right { display: flex; align-items: center; gap: 1.5rem; }
    .header-title { font-family: var(--font-display); font-size: 1.5rem; color: var(--slate-blue); }
    .back-link { font-size: 0.85rem; color: var(--slate-blue); padding: 0.5rem 1rem; border: 1px solid var(--slate-blue); border-radius: 4px; text-decoration: none; transition: all 0.3s; }
    .back-link:hover { background: var(--slate-blue); color: var(--white); }
    
    /* Layout */
    .main { display: flex; height: calc(100vh - 60px); margin-top: 60px; }
    
    /* Sidebar */
    .sidebar {
      width: 320px;
      background: var(--white);
      border-right: 1px solid rgba(30,58,95,0.1);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    .sidebar-header {
      padding: 1.25rem;
      background: var(--slate-blue);
      color: var(--white);
    }
    .sidebar-header h2 { font-family: var(--font-display); font-size: 1.1rem; margin-bottom: 0.25rem; }
    .sidebar-header p { font-size: 0.8rem; opacity: 0.8; }
    
    .filters { padding: 1rem; border-bottom: 1px solid rgba(30,58,95,0.1); }
    .filter-group { margin-bottom: 0.75rem; }
    .filter-group label { display: block; font-size: 0.75rem; font-weight: 600; color: var(--text); margin-bottom: 0.25rem; text-transform: uppercase; letter-spacing: 0.5px; }
    .filter-group select, .filter-group input {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 0.85rem;
      font-family: var(--font-body);
    }
    .filter-group select:focus, .filter-group input:focus { outline: none; border-color: var(--heritage-ocre); }
    
    .stats {
      padding: 0.75rem 1rem;
      background: var(--cream);
      font-size: 0.8rem;
      color: var(--text);
      display: flex;
      justify-content: space-between;
    }
    .stats strong { color: var(--heritage-ocre); }
    
    .articles-list {
      flex: 1;
      overflow-y: auto;
      padding: 0.5rem;
    }
    .article-card {
      background: var(--cream);
      border-radius: 8px;
      padding: 0.75rem;
      margin-bottom: 0.5rem;
      cursor: pointer;
      transition: all 0.2s;
      border-left: 3px solid transparent;
    }
    .article-card:hover { border-left-color: var(--heritage-ocre); transform: translateX(3px); }
    .article-card.active { border-left-color: var(--alpine-green); background: rgba(45,106,79,0.1); }
    .article-title { font-size: 0.85rem; font-weight: 600; color: var(--slate-blue); margin-bottom: 0.25rem; line-height: 1.3; }
    .article-meta { font-size: 0.7rem; color: var(--text); opacity: 0.7; }
    .article-meta span { margin-right: 0.75rem; }
    .article-themes { margin-top: 0.35rem; display: flex; flex-wrap: wrap; gap: 0.25rem; }
    .theme-tag { font-size: 0.65rem; background: var(--white); padding: 0.15rem 0.4rem; border-radius: 3px; color: var(--slate-blue); }
    
    /* Map */
    .map-container { flex: 1; position: relative; }
    #map { height: 100%; width: 100%; }
    
    /* Popup */
    .leaflet-popup-content { max-width: 280px; }
    .popup-title { font-family: var(--font-display); font-size: 1rem; color: var(--slate-blue); margin-bottom: 0.5rem; }
    .popup-count { font-size: 0.85rem; color: var(--heritage-ocre); font-weight: 600; margin-bottom: 0.5rem; }
    .popup-articles { max-height: 200px; overflow-y: auto; }
    .popup-article { padding: 0.5rem 0; border-bottom: 1px solid #eee; font-size: 0.8rem; }
    .popup-article:last-child { border-bottom: none; }
    .popup-article-title { font-weight: 600; color: var(--slate-blue); }
    .popup-article-meta { font-size: 0.7rem; color: #666; margin-top: 0.15rem; }
    
    /* Legend */
    .legend {
      position: absolute;
      bottom: 20px;
      right: 20px;
      background: var(--white);
      padding: 1rem;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      z-index: 500;
      font-size: 0.75rem;
    }
    .legend h4 { font-family: var(--font-display); font-size: 0.85rem; margin-bottom: 0.5rem; color: var(--slate-blue); }
    .legend-item { display: flex; align-items: center; gap: 0.5rem; margin: 0.25rem 0; }
    .legend-color { width: 12px; height: 12px; border-radius: 50%; }
    
    /* Mobile */
    @media (max-width: 768px) {
      .header { padding: 0.75rem 1rem; }
      .header-title { display: none; }
      .sidebar { position: absolute; left: -320px; z-index: 600; height: calc(100vh - 60px); transition: left 0.3s; }
      .sidebar.open { left: 0; }
      .sidebar-toggle { display: block; position: absolute; left: 10px; top: 70px; z-index: 500; background: var(--white); border: none; padding: 0.75rem; border-radius: 4px; box-shadow: 0 2px 8px rgba(0,0,0,0.15); cursor: pointer; font-size: 1.25rem; }
      .legend { bottom: 10px; right: 10px; padding: 0.75rem; }
    }
    @media (min-width: 769px) {
      .sidebar-toggle { display: none; }
    }
  </style>
</head>
<body>
  <header class="header">
    <a href="index.html" class="logo">
      <span class="logo-main">VIZILLE</span>
      <span class="logo-sub">ESCALE<span class="logo-des">DES</span>ALPES</span>
    </a>
    <h1 class="header-title">üó∫Ô∏è Carte Patrimoniale</h1>
    <div class="header-right">
      <a href="https://mich59139.github.io/AHPV/" target="_blank" class="back-link">üìö Catalogue AHPV</a>
      <a href="index.html" class="back-link">‚Üê Retour</a>
    </div>
  </header>
  
  <button class="sidebar-toggle" onclick="toggleSidebar()">‚ò∞</button>
  
  <main class="main">
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <h2>Patrimoine du Pays Vizillois</h2>
        <p>Source : Revue M√©moire - AHPV (1991-2024)</p>
      </div>
      
      <div class="filters">
        <div class="filter-group">
          <label>Commune</label>
          <select id="filterCommune">
            <option value="">Toutes les communes</option>
            <option value="Vizille">Vizille</option>
            <option value="Jarrie">Jarrie</option>
            <option value="Montchaboud">Montchaboud</option>
            <option value="Vaulnaveys">Vaulnaveys (Haut & Bas)</option>
            <option value="M√©sage">Les M√©sages</option>
          </select>
        </div>
        <div class="filter-group">
          <label>Th√®me</label>
          <select id="filterTheme">
            <option value="">Tous les th√®mes</option>
            <option value="B√¢timents">üèõÔ∏è B√¢timents & √©difices</option>
            <option value="Religions">‚õ™ Religion</option>
            <option value="Guerres">‚öîÔ∏è Guerres</option>
            <option value="Personnages">üë§ Personnages remarquables</option>
            <option value="Activit√©s industrielles">üè≠ Industrie</option>
            <option value="Vie locale">üë®‚Äçüë©‚Äçüëß Vie locale</option>
            <option value="Ev√®nements">üìÖ √âv√©nements</option>
            <option value="Arts">üé≠ Arts & Culture</option>
          </select>
        </div>
        <div class="filter-group">
          <label>Recherche</label>
          <input type="text" id="filterSearch" placeholder="Titre, auteur...">
        </div>
      </div>
      
      <div class="stats">
        <span><strong id="countFiltered">0</strong> articles affich√©s</span>
        <span><strong id="countLieux">0</strong> lieux</span>
      </div>
      
      <div class="articles-list" id="articlesList"></div>
    </aside>
    
    <div class="map-container">
      <div id="map"></div>
      <div class="legend">
        <h4>L√©gende</h4>
        <div class="legend-item"><span class="legend-color" style="background:#1e3a5f"></span> Vizille</div>
        <div class="legend-item"><span class="legend-color" style="background:#c9a227"></span> Jarrie</div>
        <div class="legend-item"><span class="legend-color" style="background:#2d6a4f"></span> Vaulnaveys</div>
        <div class="legend-item"><span class="legend-color" style="background:#8b5cf6"></span> Montchaboud</div>
        <div class="legend-item"><span class="legend-color" style="background:#ec4899"></span> Les M√©sages</div>
      </div>
    </div>
  </main>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js"></script>
  <script src="js/patrimoine-data.js"></script>
  <script src="js/patrimoine.js"></script>
</body>
</html>
